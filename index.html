<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paz y naturaleza</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"> <!-- Importar la fuente Roboto -->
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.0/dist/aframe-extras.min.js"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif; /* Aplicar la fuente Roboto */
    }

    /* Estilos para el logo */
    #logo {
      position: fixed;
      top: 20px; /* Ajusta la posición según sea necesario */
      left: 50%;
      transform: translateX(-50%);
      z-index: 10; /* Asegúrate de que esté por encima de otros elementos */
    }

    /* Estilos para el mensaje de acceso */
    #access-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border: 1px solid black;
      display: none; /* Comienza oculto */
      z-index: 20; /* Asegúrate de que esté por encima del logo */
    }
  </style>
</head>

<body style="margin: 0; overflow: hidden;">
  <audio id="audio" loop>
    <source src="assets/esapAudio.mp3" type="audio/mp3">
    Tu navegador no soporta el elemento de audio.
  </audio>

  <!-- Logo -->
  <img id="logo" src="assets/esap-cop.png" alt="Logo" width="200"> <!-- Cambia la ruta y el tamaño según sea necesario -->

  <!-- Mensaje de solicitud de acceso -->
  <div id="access-message">
    Este sitio web inmersivo requiere acceso a los sensores de movimiento de tu dispositivo.
    <br><br>
    <button id="allow-button">Permitir</button>
    <button id="deny-button">Denegar</button>
  </div>

  <a-scene embedded arjs="sourceType: webcam; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
    <a-marker type="pattern" url="assets/pattern-esapActive.patt">
      <a-entity gltf-model="assets/esapAnimation.glb" scale="0.3 0.3 0.3" position="0 0.5 0" rotation="-120 0 0"
        animation-mixer="clip: *;loop: repeat;"></a-entity>
    </a-marker>
    <a-entity camera></a-entity>
  </a-scene>

  <script>
    var audio = document.getElementById('audio');

    function startAudio() {
      audio.play();
      document.removeEventListener('click', startAudio);
      document.removeEventListener('touchstart', startAudio);
    }
    document.addEventListener('click', startAudio);
    document.addEventListener('touchstart', startAudio);

    // Mostrar mensaje de acceso
    document.getElementById('access-message').style.display = 'block';

    // Manejar la solicitud de permisos
    document.getElementById('allow-button').addEventListener('click', function() {
      document.getElementById('access-message').style.display = 'none'; // Ocultar el mensaje
      document.getElementById('logo').style.display = 'none'; // Ocultar el logo
      if (typeof DeviceMotionEvent.requestPermission === 'function') {
        DeviceMotionEvent.requestPermission()
          .then(function(response) {
            if (response === 'granted') {
              console.log('Permisos de movimiento concedidos');
            } else {
              console.log('Permisos de movimiento denegados por el usuario');
            }
          })
          .catch(function(error) {
            console.error('Error al solicitar permisos:', error);
          });
      }
    });

    document.getElementById('deny-button').addEventListener('click', function() {
      document.getElementById('access-message').style.display = 'none'; // También oculta el mensaje al denegar
      document.getElementById('logo').style.display = 'none'; // Ocultar el logo al denegar
      console.log('Permisos de movimiento denegados');
    });
  </script>

</body>
</html>
